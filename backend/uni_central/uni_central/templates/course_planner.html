{% extends 'base.html' %}
{% load static %}

{% block content %}
<main class="main-content">
    <section class="hero">
        <div class="text-content">
            <div class="text-container">
                <h1>Course Planner</h1>
                <h2>Plan your courses by adding semesters, courses, and credits to create a roadmap to your degree.</h2>
            </div>
        </div>
    </section>
    
    <!-- Transcript Upload Section -->
    <div class="transcript-upload-section">
        <div class="upload-container">
            <h2>Quick Add from Transcript</h2>
            <p>Upload your transcript to automatically add courses to your planner</p>
            
            <div class="upload-box" id="upload-box">
                <div class="upload-icon">
                    <i class="fas fa-file-upload"></i>
                </div>
                <div class="upload-text">
                    <p>Drag & drop your transcript here or</p>
                    <label for="transcript-file" class="upload-button">Choose File</label>
                    <input type="file" id="transcript-file" accept=".pdf,.jpg,.jpeg,.png" hidden>
                </div>
                <div class="supported-formats">
                    <p>Supported formats: PDF, JPG, PNG</p>
                </div>
            </div>
            
            <div id="upload-progress" class="upload-progress">
                <div class="progress-bar">
                    <div class="progress-fill"></div>
                </div>
                <div class="progress-text">Processing transcript...</div>
            </div>
            
            <div id="results-preview" class="results-preview">
                <!-- Results will be dynamically inserted here -->
            </div>
        </div>
    </div>

    <div id="course-planner">
        <button class="add-semester" onclick="showSemesterPopup()">Add Semester +</button>
        <div id="course-planner-container">
            <!-- Semesters will be rendered here -->
        </div>
    </div>

    <!-- Semester Popup -->
    <div class="semester-popup-overlay" id="semester-popup">
        <div class="semester-popup-content">
            <button class="close-popup" onclick="closeSemesterPopup()">&times;</button>
            <h2 class="semester-popup-title">Enter your desired semester</h2>
            <div class="semester-popup-body">
                <select id="term-select">
                    <option value="Fall">Fall</option>
                    <option value="Spring">Spring</option>
                    <option value="Summer">Summer</option>
                </select>
                <input type="number" id="year-input" placeholder="Year">
            </div>
            <div class="popup-buttons">
                <button class="semester-popup-button submit" onclick="submitSemester()">Add +</button>
            </div>
        </div>
    </div>

    <!-- Course Popup -->
    <div class="semester-popup-overlay" id="course-popup">
        <div class="semester-popup-content">
            <button class="close-popup" onclick="closeCoursePopup()">&times;</button>
            <h2 class="semester-popup-title">Add Course</h2>
            <div class="semester-popup-body">
                <input type="text" id="course-code" placeholder="Course Code (e.g., CS 1410)">
                <input type="text" id="course-name" placeholder="Course Name">
                <input type="number" id="course-credits" placeholder="Credits" min="1" max="6">
            </div>
            <div class="popup-buttons">
                <button class="semester-popup-button submit" onclick="submitCourse()">Add Course</button>
            </div>
        </div>
    </div>
</main>

{% csrf_token %}
{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/course_planner.css' %}">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
{% endblock %}

{% block extra_js %}
<script type="module" src="{% static 'js/auth.js' %}"></script>
<script type="module" src="{% static 'js/course_planner.js' %}"></script>
{% endblock %}